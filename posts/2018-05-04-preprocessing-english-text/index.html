<!doctype html><html lang=en><head><meta charset=utf-8><title>Jay Vala</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Steps involved in the processing and cleaning the English corpus of EU summaries"><meta property="og:title" content="English Corpus Preprocessing"><meta property="og:description" content="Steps involved in the processing and cleaning the English corpus of EU summaries"><meta property="og:type" content="website"><meta property="og:url" content="https://jdvala.github.io/posts/2018-05-04-preprocessing-english-text/"><meta itemprop=name content="English Corpus Preprocessing"><meta itemprop=description content="Steps involved in the processing and cleaning the English corpus of EU summaries"><meta name=twitter:card content="summary"><meta name=twitter:title content="English Corpus Preprocessing"><meta name=twitter:description content="Steps involved in the processing and cleaning the English corpus of EU summaries"><link rel=apple-touch-icon sizes=180x180 href=apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=favicon-32.png><link rel=stylesheet href=https://jdvala.github.io/scss/style.min.d1aa507e320f63a9a89fb4d16c025955cea1564900de1060a4b2d7cabbabcdec.css></head><body><header><div class="header header-frame"><div><h1 class=header__title>English Corpus Preprocessing</h1><div class=header__description>Steps involved in the processing and cleaning the English corpus of EU summaries</div></div><nav class=header-nav><ul class="header-nav-list header-nav-list--menu"><li class=header-nav-list__item><a class=header-nav-list__link href=/about/><span>About</span></a></li></ul><button class=header-nav-list__nav-btn>navigation</button></nav><button class=mb-header__menu-btn>
<span class=mb-header__menu-btn-line></span><span class=mb-header__menu-btn-line></span><span class=mb-header__menu-btn-line></span></button></div><nav id=mobile-header-nav class=mb-header-nav><button class="mb-header-nav__close-btn flex-center"><svg class="mb-header-nav__svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"
            ><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                /><path d="M0 0h24v24H0z" fill="none" /></svg></button><div class=mb-header-nav__wrapper><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"
                ><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Tags</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/python/>python</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/text/>text</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/text-preprocessing/>text-preprocessing</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/nlp/>nlp</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/text-cleaning/>text-cleaning</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/preprocessing/>preprocessing</a></li></ul></div><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"
                ><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Menu</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=/about/>About</a></li></ul></div></div></nav></header><div id=content><article class=post><div class=post-content><h1 id=steps-in-preprocessing-english-text>Steps in preprocessing English text</h1><p>Before feeding text to any deep learning model it is advisable to preprocess the text to make it more suitable for the model. Preprocessing in general means cleaning the data to make it more convenient for any or all deep learning models to learn properly and efficiently.</p><p>Preprocessing is subjective, that means it depends on the purpose of preprocessing, depends on data, depends on language and also depends on the type of technique one would be adapting, but there are a lot of steps in preprocessing that does not depend on any of the above mentioned things, but its more of something that has to be done no matter what.</p><p>In my thesis I will be using set of preprocessing rules that I think will make learning more effective for my model that I am planning on using.</p><h3 id=rules>Rules:</h3><ul><li>All characters to lower case or upper case.</li><li>Sentence tokenize the text.</li><li>Remove numbers.</li><li>Remove currency symbols.</li><li>Remove all the punctuation.</li><li>Remove English stop words.</li><li>Remove other unicode characters(if any).</li><li>Perform Lemmatization or Stemming.</li></ul><p>Let&rsquo;s go ahead and see how to do these things in python.</p><p><strong>NOTE: I am using anaconda as my virtual environment, I will soon add how to setup anaconda and virtual environment in any linux system(Debain based).</strong></p><p>First step is to import necessary modules to perform the operations, I have used <a href=https://docs.python.org/3/library/re.html>Regular expressions</a>, <a href=https://docs.python.org/3/library/string.html>String</a> Class of Python, <a href=https://www.nltk.org/>NLTK Library</a>, and <a href=https://spacy.io/usage/>Spacy library</a>.</p><p>So, the first step is to sentence tokenize the text we receive, for that I am using sentence tokenizer from NLTK library.</p><p>Let&rsquo;s take an example text file for the corpus.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>SUMMARY
During the period 2004-06, the Commission is implementing a Community programme covering plant, microbial and animal genetic resources * which are or could be of use in agriculture. The amount allocated to the programme is 10 million.

The Commission selects the actions to be part-financed under the programme on the basis of calls <span style=color:#000;font-weight:700>for</span> proposals and following evaluation by independent experts. Proposals may be submitted by a public sector body or any natural or legal person who is a national of a Member State and established in the Community, in an EFTA/EEA country, or in an associated country in accordance with the conditions stipulated in a bilateral agreement.

The actions, which may last <span style=color:#000;font-weight:700>for</span> a maximum of four years, may be of three types:
targeted actions, part-financed up to a maximum of 50% of their total cost and including:- transnational actions promoting the ex situ and in situ conservation *, characterisation, collection and utilisation of genetic resources in agriculture;- the establishment of a European decentralised, permanent and widely accessible web-based inventory of genetic resources currently conserved in situ including in situ/on-farm genetic resources conservation activities;- the establishment of a European decentralised, permanent and widely accessible web-based inventory of the ex situ collections <span style=color:#000;font-weight:700>(</span>gene banks<span style=color:#000;font-weight:700>)</span> and in situ resources;- the promotion of regular exchanges of technical and scientific information among competent organisations in the Member States;
concerted actions, part-financed up to a maximum of 80% of their total cost, transnational in character and promoting the exchange of information on thematic issues <span style=color:#000;font-weight:700>for</span> the purpose of improving the coordination of actions and programmes in the sphere concerned;

accompanying actions, part-financed up to a maximum of 80% of their total cost and comprising information, dissemination and advisory actions, training courses and the preparation of technical reports.

Once an action has been approved, the Commission will conclude a grant agreement with the participants setting out detailed criteria <span style=color:#000;font-weight:700>for</span> the reporting, dissemination, protection and exploitation of the results of the action.

The Commission is assisted by a Committee on the conservation, characterisation, collection and utilisation of genetic resources in agriculture. The Commission may also call on the assistance of scientific and technical experts <span style=color:#000;font-weight:700>for</span> the implementation of the programme.

At the end of the programme, the Commission will appoint a group of independent experts to report on the implementation of the Regulation, to assess the results and to make appropriate recommendations. The group<span style=color:#a61717;background-color:#e3d2d2>&#39;</span>s report will be submitted to the European Parliament, the Council and the European Economic and Social Committee.
</code></pre></div><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>
<span style=color:#998;font-style:italic># Let&#39;s read the file </span>
<span style=color:#000;font-weight:700>from</span> <span style=color:#555>nltk.tokenize</span> <span style=color:#000;font-weight:700>import</span> sent_tokenize

<span style=color:#000;font-weight:700>with</span> <span style=color:#0086b3>open</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>Conservation, characterisation, collection and utilisation of genetic resources in agriculture.txt</span><span style=color:#d14>&#39;</span>, <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>r</span><span style=color:#d14>&#39;</span>) <span style=color:#000;font-weight:700>as</span> f:
    contents <span style=color:#000;font-weight:700>=</span> f<span style=color:#000;font-weight:700>.</span>readlines()

<span style=color:#998;font-style:italic>#NOTE: The function readlines() return a list of lines in the same format as the file is.</span>


<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>sentences</span>(list_):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Returns sentence tokenized text list</span><span style=color:#d14>&#34;&#34;&#34;</span>
    text <span style=color:#000;font-weight:700>=</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>join(list_)

    <span style=color:#998;font-style:italic># Sentence tokenize with help of sent_tokenize from nltk</span>
    sentence <span style=color:#000;font-weight:700>=</span> sent_tokenize(text)

    <span style=color:#000;font-weight:700>return</span> sentence
</code></pre></div><p>Now lets pass the <code>contents</code> to the function <code>sentences(list_)</code> and see what is the output</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>after_sent_token <span style=color:#000;font-weight:700>=</span> sentences(contents)
</code></pre></div><p>The output of the above code is</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000;font-weight:700>[</span><span style=color:#d14>&#39;SUMMARY\nDuring the period 2004-06, the Commission is implementing a Community programme covering plant, microbial and animal genetic resources * which are or could be of use in agriculture.&#39;</span>,
 <span style=color:#d14>&#39;The amount allocated to the programme is 10\xa0million.&#39;</span>,
 <span style=color:#d14>&#39;The Commission selects the actions to be part-financed under the programme on the basis of calls for proposals and following evaluation by independent experts.&#39;</span>,
 <span style=color:#d14>&#39;Proposals may be submitted by a public sector body or any natural or legal person who is a national of a Member State and established in the Community, in an EFTA/EEA country, or in an associated country in accordance with the conditions stipulated in a bilateral agreement.&#39;</span>,
 <span style=color:#d14>&#39;The actions, which may last for a maximum of four years, may be of three types:\ntargeted actions, part-financed up to a maximum of 50% of their total cost and including:- transnational actions promoting the ex situ and in situ conservation *, characterisation, collection and utilisation of genetic resources in agriculture;- the establishment of a European decentralised, permanent and widely accessible web-based inventory of genetic resources currently conserved in situ including in situ/on-farm genetic resources conservation activities;- the establishment of a European decentralised, permanent and widely accessible web-based inventory of the ex situ collections (gene banks) and in situ resources;- the promotion of regular exchanges of technical and scientific information among competent organisations in the Member States;\nconcerted actions, part-financed up to a maximum of 80% of their total cost, transnational in character and promoting the exchange of information on thematic issues for the purpose of improving the coordination of actions and programmes in the sphere concerned;\naccompanying actions, part-financed up to a maximum of 80% of their total cost and comprising information, dissemination and advisory actions, training courses and the preparation of technical reports.&#39;</span>,
 <span style=color:#d14>&#39;Once an action has been approved, the Commission will conclude a grant agreement with the participants setting out detailed criteria for the reporting, dissemination, protection and exploitation of the results of the action.&#39;</span>,
 <span style=color:#d14>&#39;The Commission is assisted by a Committee on the conservation, characterisation, collection and utilisation of genetic resources in agriculture.&#39;</span>,
 <span style=color:#d14>&#39;The Commission may also call on the assistance of scientific and technical experts for the implementation of the programme.&#39;</span>,
 <span style=color:#d14>&#39;At the end of the programme, the Commission will appoint a group of independent experts to report on the implementation of the Regulation, to assess the results and to make appropriate recommendations.&#39;</span>,
 <span style=color:#d14>&#34;The group&#39;s report will be submitted to the European Parliament, the Council and the European Economic and Social Committee.&#34;</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><p>Now, that we have sentence tokenize, we will make everything into a lower case.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#998;font-style:italic># after_sent_token is a list.</span>
<span style=color:#998;font-style:italic># Make a new list.</span>

after_lower <span style=color:#000;font-weight:700>=</span> []

<span style=color:#000;font-weight:700>for</span> line <span style=color:#000;font-weight:700>in</span> after_sent_token:
    after_lower<span style=color:#000;font-weight:700>.</span>append(line<span style=color:#000;font-weight:700>.</span>lower())
</code></pre></div><p>When we print the <code>after_lower</code> list, we get the output to be</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000;font-weight:700>[</span><span style=color:#d14>&#39;summary\nduring the period 2004-06, the commission is implementing a community programme covering plant, microbial and animal genetic resources * which are or could be of use in agriculture.&#39;</span>,
 <span style=color:#d14>&#39;the amount allocated to the programme is 10\xa0million.&#39;</span>,
 <span style=color:#d14>&#39;the commission selects the actions to be part-financed under the programme on the basis of calls for proposals and following evaluation by independent experts.&#39;</span>,
 <span style=color:#d14>&#39;proposals may be submitted by a public sector body or any natural or legal person who is a national of a member state and established in the community, in an efta/eea country, or in an associated country in accordance with the conditions stipulated in a bilateral agreement.&#39;</span>,
 <span style=color:#d14>&#39;the actions, which may last for a maximum of four years, may be of three types:\ntargeted actions, part-financed up to a maximum of 50% of their total cost and including:- transnational actions promoting the ex situ and in situ conservation *, characterisation, collection and utilisation of genetic resources in agriculture;- the establishment of a european decentralised, permanent and widely accessible web-based inventory of genetic resources currently conserved in situ including in situ/on-farm genetic resources conservation activities;- the establishment of a european decentralised, permanent and widely accessible web-based inventory of the ex situ collections (gene banks) and in situ resources;- the promotion of regular exchanges of technical and scientific information among competent organisations in the member states;\nconcerted actions, part-financed up to a maximum of 80% of their total cost, transnational in character and promoting the exchange of information on thematic issues for the purpose of improving the coordination of actions and programmes in the sphere concerned;\naccompanying actions, part-financed up to a maximum of 80% of their total cost and comprising information, dissemination and advisory actions, training courses and the preparation of technical reports.&#39;</span>,
 <span style=color:#d14>&#39;once an action has been approved, the commission will conclude a grant agreement with the participants setting out detailed criteria for the reporting, dissemination, protection and exploitation of the results of the action.&#39;</span>,
 <span style=color:#d14>&#39;the commission is assisted by a committee on the conservation, characterisation, collection and utilisation of genetic resources in agriculture.&#39;</span>,
 <span style=color:#d14>&#39;the commission may also call on the assistance of scientific and technical experts for the implementation of the programme.&#39;</span>,
 <span style=color:#d14>&#39;at the end of the programme, the commission will appoint a group of independent experts to report on the implementation of the regulation, to assess the results and to make appropriate recommendations.&#39;</span>,
 <span style=color:#d14>&#34;the group&#39;s report will be submitted to the european parliament, the council and the european economic and social committee.&#34;</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><p>Similarly, we can do everything as we did above. The full code for english preprocessing is below.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#998;font-style:italic># This preprocessing is intended for english</span>
<span style=color:#998;font-style:italic># coding: utf-8</span>

<span style=color:#000;font-weight:700>import</span> <span style=color:#555>os</span>
<span style=color:#000;font-weight:700>import</span> <span style=color:#555>sys</span>
<span style=color:#000;font-weight:700>import</span> <span style=color:#555>re</span>
<span style=color:#000;font-weight:700>import</span> <span style=color:#555>string</span>
<span style=color:#000;font-weight:700>from</span> <span style=color:#555>nltk.corpus</span> <span style=color:#000;font-weight:700>import</span> stopwords
<span style=color:#000;font-weight:700>import</span> <span style=color:#555>spacy</span>
<span style=color:#000;font-weight:700>from</span> <span style=color:#555>nltk.tokenize</span> <span style=color:#000;font-weight:700>import</span> sent_tokenize


<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>sentences</span>(list_):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Returns sentence tokenized text list</span><span style=color:#d14>&#34;&#34;&#34;</span>
    text <span style=color:#000;font-weight:700>=</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>join(list_)

    <span style=color:#998;font-style:italic># Sentence tokenize with help of sent_tokenize from nltk  </span>
    sentence <span style=color:#000;font-weight:700>=</span> sent_tokenize(text)

    <span style=color:#000;font-weight:700>return</span> sentence


<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>remove</span>(text):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Returns text with all the filtering necessary</span><span style=color:#d14>&#34;&#34;&#34;</span>
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>(</span><span style=color:#d14>\</span><span style=color:#d14>d+</span><span style=color:#d14>\</span><span style=color:#d14>.</span><span style=color:#d14>\</span><span style=color:#d14>d+)</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,text)
    <span style=color:#998;font-style:italic>#t = re.sub(r&#34;(\d+th?|st?|nd?|rd?)&#34;,&#34;&#34;, t)</span>
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>d{2}.</span><span style=color:#d14>\</span><span style=color:#d14>d{2}.</span><span style=color:#d14>\</span><span style=color:#d14>d{4}</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>d{2}</span><span style=color:#d14>\</span><span style=color:#d14>/</span><span style=color:#d14>\</span><span style=color:#d14>d{2}</span><span style=color:#d14>\</span><span style=color:#d14>/</span><span style=color:#d14>\</span><span style=color:#d14>d{4}</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>d{2}(</span><span style=color:#d14>\</span><span style=color:#d14>/|</span><span style=color:#d14>\</span><span style=color:#d14>.)</span><span style=color:#d14>\</span><span style=color:#d14>d{2}(</span><span style=color:#d14>\</span><span style=color:#d14>/|</span><span style=color:#d14>\</span><span style=color:#d14>.)</span><span style=color:#d14>\</span><span style=color:#d14>d{2}</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>($|€|¥|₹|£)</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>(</span><span style=color:#d14>%</span><span style=color:#d14>)</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>d+</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>n</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,t)
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\</span><span style=color:#d14>xa0</span><span style=color:#d14>&#34;</span>, <span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>, t)
    <span style=color:#000;font-weight:700>return</span> t

<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>pun</span>(text):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Return punctuations from text</span><span style=color:#d14>&#34;&#34;&#34;</span>
    table <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>str</span><span style=color:#000;font-weight:700>.</span>maketrans(<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>, string<span style=color:#000;font-weight:700>.</span>punctuation)
    t <span style=color:#000;font-weight:700>=</span> text<span style=color:#000;font-weight:700>.</span>translate(table)
    <span style=color:#000;font-weight:700>return</span> t


nlp <span style=color:#000;font-weight:700>=</span> spacy<span style=color:#000;font-weight:700>.</span>load(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>en</span><span style=color:#d14>&#39;</span>)

<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>lemmatizer</span>(text):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Returns text after lemmatization</span><span style=color:#d14>&#34;&#34;&#34;</span>
    sent <span style=color:#000;font-weight:700>=</span> []
    doc <span style=color:#000;font-weight:700>=</span> nlp(text)
    <span style=color:#000;font-weight:700>for</span> word <span style=color:#000;font-weight:700>in</span> doc:
        sent<span style=color:#000;font-weight:700>.</span>append(word<span style=color:#000;font-weight:700>.</span>lemma_)
    <span style=color:#000;font-weight:700>return</span> <span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14> </span><span style=color:#d14>&#34;</span><span style=color:#000;font-weight:700>.</span>join(sent)


<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>extras</span>(sentences):
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Returns text after removing some extra symbols</span><span style=color:#d14>&#34;&#34;&#34;</span>
    t <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>sub(<span style=color:#d14>r</span><span style=color:#d14>&#34;</span><span style=color:#d14>\&#34;</span><span style=color:#d14>|</span><span style=color:#d14>\</span><span style=color:#d14>—|</span><span style=color:#d14>\</span><span style=color:#d14>&#39;</span><span style=color:#d14>|</span><span style=color:#d14>\</span><span style=color:#d14>’</span><span style=color:#d14>&#34;</span>,<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>&#34;</span>,sentences)
    word_list <span style=color:#000;font-weight:700>=</span> t<span style=color:#000;font-weight:700>.</span>split()
    <span style=color:#000;font-weight:700>for</span> index, word <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>enumerate</span>(word_list):
        <span style=color:#000;font-weight:700>if</span> <span style=color:#0086b3>len</span>(word) <span style=color:#000;font-weight:700>&lt;</span><span style=color:#000;font-weight:700>=</span><span style=color:#099>1</span>:
            <span style=color:#000;font-weight:700>del</span> word_list[index]
    t <span style=color:#000;font-weight:700>=</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14> </span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>join(word_list)

    <span style=color:#000;font-weight:700>return</span> t

<span style=color:#998;font-style:italic># Stop word removal</span>
<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>stop_word</span>(sentence):
    list_ <span style=color:#000;font-weight:700>=</span> []
    stop_words <span style=color:#000;font-weight:700>=</span> stopwords<span style=color:#000;font-weight:700>.</span>words(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>english</span><span style=color:#d14>&#39;</span>)
    words_list <span style=color:#000;font-weight:700>=</span> sentence<span style=color:#000;font-weight:700>.</span>split()
    <span style=color:#000;font-weight:700>for</span> word <span style=color:#000;font-weight:700>in</span> words_list:
        <span style=color:#000;font-weight:700>if</span> word <span style=color:#000;font-weight:700>not</span> <span style=color:#000;font-weight:700>in</span> stop_words:
            list_<span style=color:#000;font-weight:700>.</span>append(word)
    <span style=color:#000;font-weight:700>return</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14> </span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>join(list_)




<span style=color:#000;font-weight:700>def</span> <span style=color:#900;font-weight:700>main</span>():
    <span style=color:#d14></span><span style=color:#d14>&#34;&#34;&#34;</span><span style=color:#d14>Main Function</span><span style=color:#d14>&#34;&#34;&#34;</span>
    <span style=color:#000;font-weight:700>with</span> <span style=color:#0086b3>open</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>Conservation, characterisation, collection and utilisation of genetic resources in agriculture.txt</span><span style=color:#d14>&#39;</span>, <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>r</span><span style=color:#d14>&#39;</span>) <span style=color:#000;font-weight:700>as</span> f:
        contents <span style=color:#000;font-weight:700>=</span> f<span style=color:#000;font-weight:700>.</span>readlines()
    <span style=color:#998;font-style:italic># Joining the lines to make text block </span>
    contents <span style=color:#000;font-weight:700>=</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>join(contents)
    <span style=color:#000;font-weight:700>print</span>(<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>Starting to preprocess file</span><span style=color:#d14>&#34;</span>)
    <span style=color:#998;font-style:italic># Sentence tokenize the text</span>
    sent_tokenized <span style=color:#000;font-weight:700>=</span> sentences(contents)
    <span style=color:#998;font-style:italic># Removing stop words</span>
    t1 <span style=color:#000;font-weight:700>=</span> [lemmatizer(sent) <span style=color:#000;font-weight:700>for</span> sent <span style=color:#000;font-weight:700>in</span> sent_tokenized]
    <span style=color:#998;font-style:italic># lemmatization </span>
    t2 <span style=color:#000;font-weight:700>=</span> [stop_word(sent) <span style=color:#000;font-weight:700>for</span> sent <span style=color:#000;font-weight:700>in</span> t1]
    <span style=color:#998;font-style:italic># Removing all the unnecessary things from the text </span>
    t3 <span style=color:#000;font-weight:700>=</span> [remove(line) <span style=color:#000;font-weight:700>for</span> line <span style=color:#000;font-weight:700>in</span> t2]
    <span style=color:#998;font-style:italic># Removing punctuations</span>
    t4 <span style=color:#000;font-weight:700>=</span>[pun(line<span style=color:#000;font-weight:700>.</span>lower()) <span style=color:#000;font-weight:700>for</span> line <span style=color:#000;font-weight:700>in</span> t3]

    t5 <span style=color:#000;font-weight:700>=</span> [extras(sent) <span style=color:#000;font-weight:700>for</span> sent <span style=color:#000;font-weight:700>in</span> t4]
    <span style=color:#000;font-weight:700>print</span>(<span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>Preprocessing done for file)</span>

    <span style=color:#000;font-weight:700>print</span>(t5)

<span style=color:#000;font-weight:700>if</span> __name__ <span style=color:#000;font-weight:700>==</span> <span style=color:#d14></span><span style=color:#d14>&#34;</span><span style=color:#d14>__main__</span><span style=color:#d14>&#34;</span>:
    main()
</code></pre></div><p>The output of the file after preprocessing will be</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#000;font-weight:700>[</span><span style=color:#d14>&#39;summary period commission implement community programme covering plant microbial animal genetic resource could use agriculture&#39;</span>, <span style=color:#d14>&#39;amount allocate programme million&#39;</span>, <span style=color:#d14>&#39;commission select action part finance programme basis call proposal follow evaluation independent expert&#39;</span>, <span style=color:#d14>&#39;proposal may submit public sector body natural legal person national member state establish community efta eea country associated country accordance condition stipulate bilateral agreement&#39;</span>, <span style=color:#d14>&#39;action may last maximum four year may three type target action part finance maximum pron total cost including transnational action promote ex situ situ conservation characterisation collection utilisation genetic resource agriculture establishment european decentralise permanent widely accessible web base inventory genetic resource currently conserve situ include situ farm genetic resource conservation activities establishment european decentralise permanent widely accessible web base inventory ex situ collection gene bank situ resources promotion regular exchange technical scientific information among competent organisation member states concerted action part finance maximum pron total cost transnational character promote exchange information thematic issue purpose improve coordination action programme sphere concern accompanying action part finance maximum pron total cost comprise information dissemination advisory action train course preparation technical report&#39;</span>, <span style=color:#d14>&#39;action approve commission conclude grant agreement participant set detailed criterion reporting dissemination protection exploitation result action&#39;</span>, <span style=color:#d14>&#39;commission assist committee conservation characterisation collection utilisation genetic resource agriculture&#39;</span>, <span style=color:#d14>&#39;commission may also call assistance scientific technical expert implementation programme&#39;</span>, <span style=color:#d14>&#39;end programme commission appoint group independent expert report implementation regulation assess result make appropriate recommendation&#39;</span>, <span style=color:#d14>&#39;group report submit european parliament council european economic social committee&#39;</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><p>This is probably all the preprocessing necessary for creating word vectors, that is what my next task is.</p></div></article><button class=floating-button>
<a class=floating-button__link href=https://jdvala.github.io><span>home</span></a></button></div><footer class=post-footer><div class=footer><div>© 2020, Jay Vala. Theme - Origin by Andrey Parfenov</div><div class=footer__socials><a href=www.github.com/jdvala target=_blank class=social-link title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0v24h24V0H0zm14.534 19.59c-.406.078-.534-.171-.534-.384v-2.195c0-.747-.262-1.233-.55-1.481 1.782-.198 3.654-.875 3.654-3.947.0-.874-.311-1.588-.824-2.147.083-.202.357-1.016-.079-2.117.0.0-.671-.215-2.198.82-.639-.18-1.323-.267-2.003-.271-.68.003-1.364.091-2.003.269-1.528-1.035-2.2-.82-2.2-.82-.434 1.102-.16 1.915-.077 2.118-.512.56-.824 1.273-.824 2.147.0 3.064 1.867 3.751 3.645 3.954-.229.2-.436.552-.508 1.07-.457.204-1.614.557-2.328-.666.0.0-.423-.768-1.227-.825.0.0-.78-.01-.055.487.0.0.525.246.889 1.17.0.0.463 1.428 2.688.944v1.489c0 .211-.129.459-.528.385-3.18-1.057-5.472-4.056-5.472-7.59.0-4.419 3.582-8 8-8s8 3.581 8 8c0 3.533-2.289 6.531-5.466 7.59z"/></svg></a></div></div></footer><script src=https://jdvala.github.io/js/script.js></script></body></html>