<!doctype html><html lang=en><head><meta charset=utf-8><title>Jay Vala</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Dance my docker, dance"><meta property="og:title" content="Orchesrating Docker Swarm"><meta property="og:description" content="Dance my docker, dance"><meta property="og:type" content="website"><meta property="og:url" content="https://jdvala.github.io/posts/2020-10-01-orchestrating-docker-swarm/"><meta itemprop=name content="Orchesrating Docker Swarm"><meta itemprop=description content="Dance my docker, dance"><meta name=twitter:card content="summary"><meta name=twitter:title content="Orchesrating Docker Swarm"><meta name=twitter:description content="Dance my docker, dance"><link rel=apple-touch-icon sizes=180x180 href=apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=favicon-32.png><link rel=stylesheet href=https://jdvala.github.io/scss/style.min.d1aa507e320f63a9a89fb4d16c025955cea1564900de1060a4b2d7cabbabcdec.css></head><body><header><div class="header header-frame"><div><h1 class=header__title>Orchesrating Docker Swarm</h1><div class=header__description>Dance my docker, dance</div></div><nav class=header-nav><ul class="header-nav-list header-nav-list--menu"><li class=header-nav-list__item><a class=header-nav-list__link href=/about/><span>About</span></a></li></ul><button class=header-nav-list__nav-btn>navigation</button></nav><button class=mb-header__menu-btn>
<span class=mb-header__menu-btn-line></span><span class=mb-header__menu-btn-line></span><span class=mb-header__menu-btn-line></span></button></div><nav id=mobile-header-nav class=mb-header-nav><button class="mb-header-nav__close-btn flex-center"><svg class="mb-header-nav__svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"
            ><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                /><path d="M0 0h24v24H0z" fill="none" /></svg></button><div class=mb-header-nav__wrapper><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"
                ><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Tags</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/docker/>docker</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/docker-swarm/>docker-swarm</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/orchestration/>orchestration</a></li></ul></div><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"
                ><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Menu</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=/about/>About</a></li></ul></div></div></nav></header><div id=content><article class=post><div class=post-content><p>Initalize a swarm on a node which you can prefer, to create a manager. The architecture of the docker swarm orchestration is that it has a manager node (which is a whole node or computer). Then there are worker nodes which can be controlled or manage by the manager node.</p><p><img src=https://camo.githubusercontent.com/2414d3a74f17d5601aa0abb140ca97ea3eab8ad4/68747470733a2f2f692e706f7374696d672e63632f4d4b4850383959792f737761726d2e6a7067 alt=Architecture></p><p>(image: <a href=https://blog.knoldus.com/orchestration-with-docker-swarm/>https://blog.knoldus.com/orchestration-with-docker-swarm/</a>)</p><p>In the diagram above the swam manager is a node which is used to control the swam nodes. In general terminology swarm manager is refered to as <code>manager</code> and the swarm nodes are refered to as <code>workers</code> or <code>worker nodes</code>.</p><h3 id=create-a-swarm>Create a swarm</h3><p>To create a swam first we need to create a manager. SSH into a machine and run the command</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker swarm init --advertise-addr &lt;ip-address&gt;
</code></pre></div><p>In the above command we tell docker to initalize a docker swarm for us, but when we want to manage the worker nodes or when we want to communicate with the worker nodes we need an <code>IP</code> address for the manager to publish in order for workers to connect to our managers, so the command argument <code>--advertise-addr</code> will advertise the <code>IP</code> address that follows the command for workder nodes of other managers to connect to this manager node.</p><blockquote><p>In case we want to use only one node, we can simply run <code>docker swarm init</code></p></blockquote><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ docker swarm init --advertise-addr 192.168.0.23 
Swarm initialized: current node <span style=color:#000;font-weight:700>(</span>v6l24ilbz1bq72ad8tklhipxx<span style=color:#000;font-weight:700>)</span> is now a manager.

To add a worker to this swarm, run the following command:

    docker swarm join --token SWMTKN-1-04i6f00j63iyiqts65tynfapes4qx6bhxap21lod0k69jzmol3-5tjti3fxaqg94qkv3zf86k6ai 192.168.0.23:2377

To add a manager to this swarm, run <span style=color:#d14>&#39;docker swarm join-token manager&#39;</span> and follow the instructions.
</code></pre></div><p>Now we can use <code>docker info</code> to display the information about the current state or our swarm.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker info

Client:
 Debug Mode: <span style=color:#0086b3>false</span>
 Plugins:
  app: Docker App <span style=color:#000;font-weight:700>(</span>Docker Inc., v0.9.1-beta3<span style=color:#000;font-weight:700>)</span>

Server:
 Containers: <span style=color:#099>0</span>
  Running: <span style=color:#099>0</span>
  Paused: <span style=color:#099>0</span>
  Stopped: <span style=color:#099>0</span>
 Images: <span style=color:#099>1</span>
 Server Version: 19.03.11
 Storage Driver: overlay2
  Backing Filesystem: xfs
  Supports d_type: <span style=color:#0086b3>true</span>
  Native Overlay Diff: <span style=color:#0086b3>true</span>
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Plugins:
  Volume: <span style=color:#0086b3>local</span>
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file <span style=color:#0086b3>local</span> logentries splunk syslog
 Swarm: active
  NodeID: v6l24ilbz1bq72ad8tklhipxx
  Is Manager: <span style=color:#0086b3>true</span>
  ClusterID: 6a4b0em1ndyg52odc43guyr1i
  Managers: <span style=color:#099>1</span>
  Nodes: <span style=color:#099>2</span>
  Default Address Pool: 10.0.0.0/8  
  SubnetSize: <span style=color:#099>24</span>
  Data Path Port: <span style=color:#099>4789</span>
  Orchestration:
   Task History Retention Limit: <span style=color:#099>5</span>
  Raft:
   Snapshot Interval: <span style=color:#099>10000</span>
   Number of Old Snapshots to Retain: <span style=color:#099>0</span>
   Heartbeat Tick: <span style=color:#099>1</span>
   Election Tick: <span style=color:#099>10</span>
  Dispatcher:
   Heartbeat Period: <span style=color:#099>5</span> seconds
  CA Configuration:
   Expiry Duration: <span style=color:#099>3</span> months
   Force Rotate: <span style=color:#099>0</span>
  Autolock Managers: <span style=color:#0086b3>false</span>
  Root Rotation In Progress: <span style=color:#0086b3>false</span>
  Node Address: 192.168.0.23
  Manager Addresses:
   192.168.0.23:2377
 Runtimes: runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 7ad184331fa3e55e52b890ea95e65ba581ae3429
 runc version: dc9208a3303feef5b3839f4323d9beb36df0a9dd
 init version: fec3683
 Security Options:
  apparmor
  seccomp
   Profile: default
 Kernel Version: 4.4.0-186-generic
 Operating System: Alpine Linux v3.12 <span style=color:#000;font-weight:700>(</span>containerized<span style=color:#000;font-weight:700>)</span>
 OSType: linux
 Architecture: x86_64
 CPUs: <span style=color:#099>8</span>
 Total Memory: 31.4GiB
 Name: node1
 ID: XHBK:ACSE:UHWV:LFEY:MCE2:BAOA:775R:DK6P:CBYL:3RDJ:2WHV:QQ4M
 Docker Root Dir: /var/lib/docker
 Debug Mode: <span style=color:#0086b3>true</span>
  File Descriptors: <span style=color:#099>38</span>
  Goroutines: <span style=color:#099>164</span>
  System Time: 2020-09-01T08:25:22.272726765Z
  EventsListeners: <span style=color:#099>0</span>
 Registry: https://index.docker.io/v1/
 Labels:
 Experimental: <span style=color:#0086b3>true</span>
 Insecure Registries:
  127.0.0.1
  127.0.0.0/8
 Live Restore Enabled: <span style=color:#0086b3>false</span>
 Product License: Community Engine

WARNING: API is accessible on http://0.0.0.0:2375 without encryption.
         Access to the remote API is equivalent to root access on the host. Refer
         to the <span style=color:#d14>&#39;Docker daemon attack surface&#39;</span> section in the documentation <span style=color:#000;font-weight:700>for</span>
         more information: https://docs.docker.com/engine/security/security/#docker-daemon-attack-surface
WARNING: No swap limit support
WARNING: bridge-nf-call-iptables is disabled
WARNING: bridge-nf-call-ip6tables is disabled
</code></pre></div><p>we can also run <code>docker node ls</code> to see information about all the nodes.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker node ls

ID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION
v6l24ilbz1bq72ad8tklhipxx *   node1               Ready               Active              Leader              19.03.11
pw51r1us9l1ou62pdh3ff3dp2     node2               Ready               Active                                  19.03.11
</code></pre></div><blockquote><p>The * indicates we are connected to the that node.</p></blockquote><h3 id=add-nodes-to-the-swarm>Add nodes to the swarm</h3><p>To add nodes to the swarm run the command displayed when we initalized the swarm.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker swarm join --token SWMTKN-1-04i6f00j63iyiqts65tynfapes4qx6bhxap21lod0k69jzmol3-5tjti3fxaqg94qkv3zf86k6ai 192.168.0.23:2377
</code></pre></div><p>This will spawn up a node (worker). Please note that this command has to be run on a different physical computer. Also the <code>IP</code> address specified <code>192.168.0.23:2377</code> should be accessible to this machine where we are spawning a worker node.</p><p>If the command from the init swarm command is not accessible you can run <code>docker swarm join-token worker</code> to get the command.</p><p>Once the node is setup. We can use <code>docker node ls</code> to see how many nodes we have. I had already setup a node so you can see the output in my previous <code>docker node ls</code> command.</p><h3 id=deploy-a-service>Deploy a service</h3><p>I will run a simple <code>helloworld</code> program which will ping <code>google.com</code></p><p>To create a service we use <code>docker service create</code> command</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker create servec --replica <span style=color:#099>3</span> --name helloworld alpine ping jayvala.in
</code></pre></div><p>The above command will create a service named <code>helloworld</code> with base image as <code>alpine</code> and the command as the last argument <code>ping google.com</code></p><p>The <code>replicas</code> flag is important here. It specifices on how many instances we want to run this services. Its good practice to have more than one replica as it helps in high availibility.</p><blockquote><p>For the swarm manager too can be an instance so once you execute this command it can spawn the service on manager too.</p></blockquote><p>We can use <code>docker service ls</code> command to see the list of services running.</p><p>To inspect the service running on our swarm we can use</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ docker service inspect --pretty helloworld

ID:             cnpv2ykky1lmm5vpdd9id0u0q
Name:           helloworld
Service Mode:   Replicated
 Replicas:      <span style=color:#099>3</span>
Placement:
UpdateConfig:
 Parallelism:   <span style=color:#099>1</span>
 On failure:    pause
 Monitoring Period: 5s
 Max failure ratio: <span style=color:#099>0</span>
 Update order:      stop-first
RollbackConfig:
 Parallelism:   <span style=color:#099>1</span>
 On failure:    pause
 Monitoring Period: 5s
 Max failure ratio: <span style=color:#099>0</span>
 Rollback order:    stop-first
ContainerSpec:
 Image:         alpine:latest@sha256:185518070891758909c9f839cf4ca393ee977ac378609f700f60a771a2dfe321
 Args:          ping jayvala.com 
 Init:          <span style=color:#0086b3>false</span>
Resources:
Endpoint Mode:  vip
</code></pre></div><p>Now lets see which nodes in our swarm is running our helloworld service</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ docker service ps helloworld
ID                  NAME                IMAGE               NODE                DESIRED STATE       CURRENT STATE           ERROR               PORTS
zl1z36sfzr50        helloworld.1        alpine:latest       node2               Running             Running <span style=color:#099>4</span> minutes ago                       
b3pb76uuvpsi        helloworld.2        alpine:latest       node1               Running             Running <span style=color:#099>4</span> minutes ago                       
21y3swo9n8cj        helloworld.3        alpine:latest       node2               Running             Running <span style=color:#099>4</span> minutes ago                       
</code></pre></div><p>As we can see that we have 3 helloworld services running, one on <code>node 1</code> and two on <code>node 2</code>.</p><p>Now as the users consuming this services increase we would want to scale up these services.</p><h3 id=scale-up-the-service>Scale up the service</h3><p>To scale up the we can use the following command</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker service scale &lt;service name&gt;<span style=color:#000;font-weight:700>=</span>&lt;number of tasks&gt;
</code></pre></div><p>We can se here that we can replicate the tasks (a task is nothing but a single instance of a service).</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker service scale <span style=color:teal>helloworld</span><span style=color:#000;font-weight:700>=</span><span style=color:#099>10</span>

helloworld scaled to <span style=color:#099>10</span>
overall progress: <span style=color:#099>10</span> out of <span style=color:#099>10</span> tasks 
1/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
2/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
3/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
4/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
5/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
6/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
7/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
8/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
9/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
10/10: running   <span style=color:#000;font-weight:700>[</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span><span style=color:#000;font-weight:700>=</span>&gt;<span style=color:#000;font-weight:700>]</span> 
verify: Service converged 
</code></pre></div><p>The above command started 10 more replicas of the helloworld services.</p><p>Now to see which nodes are running how many process we can simply use</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker service ps helloworld

$ docker service ps helloworld
ID                  NAME                IMAGE               NODE                DESIRED STATE       CURRENT STATE                ERROR               PORTS
zl1z36sfzr50        helloworld.1        alpine:latest       node2               Running             Running <span style=color:#099>11</span> minutes ago                           
b3pb76uuvpsi        helloworld.2        alpine:latest       node1               Running             Running <span style=color:#099>11</span> minutes ago                           
21y3swo9n8cj        helloworld.3        alpine:latest       node2               Running             Running <span style=color:#099>11</span> minutes ago                           
5e650ivizaet        helloworld.4        alpine:latest       node2               Running             Running about a minute ago                       
2u0cz08jp9sk        helloworld.5        alpine:latest       node1               Running             Running about a minute ago                       
011vnxwzyjd3        helloworld.6        alpine:latest       node2               Running             Running about a minute ago                       
drwrg7ixa42p        helloworld.7        alpine:latest       node1               Running             Running about a minute ago                       
mcl513va9pes        helloworld.8        alpine:latest       node1               Running             Running about a minute ago                       
6c7lwv522f4x        helloworld.9        alpine:latest       node2               Running             Running about a minute ago                       
4441rdl391rv        helloworld.10       alpine:latest       node1               Running             Running about a minute ago      
</code></pre></div><p>Now on manager node we can do <code>docker ps</code> and it will list out all the tasks its been running, we can do the same on any node.</p><h3 id=deleting-the-service>Deleting the service</h3><p>To remove the service completely we can use</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker service rm helloworld
</code></pre></div><p>Now we can run the command <code>docker ps</code> to verify all our services are deleted or not.</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre></div></div></article><button class=floating-button>
<a class=floating-button__link href=https://jdvala.github.io><span>home</span></a></button></div><footer class=post-footer><div class=footer><div>© 2020, Jay Vala. Theme - Origin by Andrey Parfenov</div><div class=footer__socials><a href=www.github.com/jdvala target=_blank class=social-link title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0v24h24V0H0zm14.534 19.59c-.406.078-.534-.171-.534-.384v-2.195c0-.747-.262-1.233-.55-1.481 1.782-.198 3.654-.875 3.654-3.947.0-.874-.311-1.588-.824-2.147.083-.202.357-1.016-.079-2.117.0.0-.671-.215-2.198.82-.639-.18-1.323-.267-2.003-.271-.68.003-1.364.091-2.003.269-1.528-1.035-2.2-.82-2.2-.82-.434 1.102-.16 1.915-.077 2.118-.512.56-.824 1.273-.824 2.147.0 3.064 1.867 3.751 3.645 3.954-.229.2-.436.552-.508 1.07-.457.204-1.614.557-2.328-.666.0.0-.423-.768-1.227-.825.0.0-.78-.01-.055.487.0.0.525.246.889 1.17.0.0.463 1.428 2.688.944v1.489c0 .211-.129.459-.528.385-3.18-1.057-5.472-4.056-5.472-7.59.0-4.419 3.582-8 8-8s8 3.581 8 8c0 3.533-2.289 6.531-5.466 7.59z"/></svg></a></div></div></footer><script src=https://jdvala.github.io/js/script.js></script></body></html>