<!doctype html><html lang=en><head><meta charset=utf-8><title>Jay Vala</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The difficulties in parsing EU summaries"><meta property="og:title" content="Parsing EU Summaries"><meta property="og:description" content="The difficulties in parsing EU summaries"><meta property="og:type" content="website"><meta property="og:url" content="https://jdvala.github.io/posts/parsing-eur-lex-summaries/"><meta itemprop=name content="Parsing EU Summaries"><meta itemprop=description content="The difficulties in parsing EU summaries"><meta name=twitter:card content="summary"><meta name=twitter:title content="Parsing EU Summaries"><meta name=twitter:description content="The difficulties in parsing EU summaries"><link rel=apple-touch-icon sizes=180x180 href=apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=favicon-32.png><link rel=stylesheet href=https://jdvala.github.io/scss/style.min.d1aa507e320f63a9a89fb4d16c025955cea1564900de1060a4b2d7cabbabcdec.css></head><body><header><div class="header header-frame"><div><h1 class=header__title>Parsing EU Summaries</h1><div class=header__description>The difficulties in parsing EU summaries</div></div><nav class=header-nav><ul class="header-nav-list header-nav-list--menu"><li class=header-nav-list__item><a class=header-nav-list__link href=/about/><span>About</span></a></li></ul><button class=header-nav-list__nav-btn>navigation</button></nav><button class=mb-header__menu-btn>
<span class=mb-header__menu-btn-line></span>
<span class=mb-header__menu-btn-line></span>
<span class=mb-header__menu-btn-line></span></button></div><nav id=mobile-header-nav class=mb-header-nav><button class="mb-header-nav__close-btn flex-center"><svg class="mb-header-nav__svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg></button><div class=mb-header-nav__wrapper><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Tags</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/python/>python</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/preprocessing-text/>preprocessing-text</a></li><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=https://jdvala.github.io/tags/eu-lex-summaries/>EU-LEX-Summaries</a></li></ul></div><div class=mb-header-nav__container><svg width="240" height="72" viewBox="0 0 240 72" class="mb-header-nav__title"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Menu</text></svg><ul class=mb-header-nav-list><li class=mb-header-nav-list__item><a class=mb-header-nav-list__link href=/about/>About</a></li></ul></div></div></nav></header><div id=content><article class=post><div class=post-content><h2 id=notes-about-findings-in-latest-parsed-documents>Notes about findings in latest parsed documents</h2><h3 id=things-to-look-out-for-when-parsing-the-data>Things to look out for when parsing the data</h3><ul><li>WHEN DOES THE DIRECTIVE ENTER INTO FORCE?</li><li>WHEN DOES THE STRATEGY APPLY?</li><li>WHEN DO THE RULES OF PROCEDURE APPLY?</li><li>WHEN DOES THE CONVENTION APPLY?</li><li>WHEN DOES THE FRAMEWORK DECISION APPLY?</li><li>WHEN DO THE REGULATION AND DECISION APPLY?</li><li>WHEN DOES THE AGREEMENT AND PROTOCOL APPLY</li><li>DATE OF ENTRY INTO FORCE</li><li>WHEN DOES THE AGREEMENT APPLY</li><li>WHEN DOES THIS ACT APPLY</li><li>WHEN DO THE CONVENTION AND THE DECISION APPLY</li><li>WHEN DOES THE COMMUNICATION APPLY</li><li>WHEN DOES THE DECISION APPLY</li><li>WHEN DO THE DECISIONS APPLY</li><li>WHEN DO THE DECISION AND THE CONVENTION APPLY</li><li>WHEN DO THE DECISION AND THE PROTOCOL APPLY</li><li>WHEN DOES THE DIRECTIVE APPLY</li><li>WHEN DOES THIS DIRECTIVE APPLY</li><li>WHEN DOES THE PARTNERSHIP AGREEMENT APPLY</li><li>WHEN DOES THE RECOMMENDATION APPLY</li><li>WHEN DOES THE REGULATION APPLY</li><li>WHEN DOES THIS REGULATION APPLY</li><li>WHEN DO THE REGULATIONS APPLY</li><li>WHEN DOES THIS REGULATION APPLY</li><li>WHEN DO THE RULES APPLY?</li><li>WHEN DID THE TREATY APPLY</li><li>WHEN DID THE TREATY APPLY</li><li>WHEN DOES THE DECISION APPLY</li><li>WHEN DOES THIS DIRECTIVE APPLY</li><li>FROM WHEN DO THE DECISION AND THE CONVENTION APPLY</li><li>RELATED ACT</li><li>RELATED DOCUMENTS</li><li>RELATED INSTRUMENTS</li></ul><h4 id=remove-all-the-above-from-the-documents-in-order-to-get-only-summary>REMOVE ALL THE ABOVE FROM THE DOCUMENTS IN ORDER TO GET ONLY SUMMARY</h4><p>Half of these things are removed so far but some of them are still left.</p><p>So I used <code>grep</code> program of linux to see if I have succesfully removed everything from the documets and make sure these are in prefect condition for preprocessing.</p><p><strong><code>grep</code> Outputs:</strong></p><ul><li><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DOES THE DIRECTIVE ENTER INTO FORCE?'</code></p></li><li><p>output:</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/Fair trial suspects’ right to interpretation and translation in criminal proceedings.txt:113:WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/enterprise/business environment/Combating late payment in business dealings.txt:61:FROM WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/consumers/consumer safety/Defective products liability.txt:249:FROM WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/education_training_youth/education and training/Lawyers practising abroad on a permanent basis — EU rules.txt:81:WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span></code></pre></div><ul><li><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DOES THE STRATEGY APPLY?'</code></p></li><li><p>output:</p></li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/combating drugs/EU drugs strategy.txt:133:WHEN DOES THE STRATEGY APPLY?
</span></span></code></pre></div><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DO THE RULES OF PROCEDURE APPLY?'</code></p><ul><li>output:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/institutional_affairs/the institutions, bodies and agencies of the union/Rules of procedure of the Council of the European Union.txt:109:WHEN DO THE RULES OF PROCEDURE APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/institutional_affairs/the institutions, bodies and agencies of the union/Rules of procedure of the EU’s General Court.txt:177:FROM WHEN DO THE RULES OF PROCEDURE APPLY?
</span></span></code></pre></div><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DOES THE CONVENTION APPLY?'</code></p><ul><li>output:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/transport/transport, energy and the environment/Civil liability <span style=color:#000;font-weight:700>for</span> oil pollution damage Bunkers Convention.txt:113:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/transport/waterborne transport/Civil liability <span style=color:#000;font-weight:700>for</span> oil pollution damage Bunkers Convention.txt:113:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/police and customs cooperation/Close cooperation between EU customs administrations <span style=color:#000;font-weight:700>(</span>Naples II Convention<span style=color:#000;font-weight:700>)</span>.txt:89:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in civil matters/Legal certainty in international trade <span style=color:#000;font-weight:700>for</span> EU businesses using choice of court agreements.txt:69:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/environment/environment  cooperation with third countries/Civil liability <span style=color:#000;font-weight:700>for</span> oil pollution damage Bunkers Convention.txt:113:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/environment/water protection and management/Civil liability <span style=color:#000;font-weight:700>for</span> oil pollution damage Bunkers Convention.txt:113:FROM WHEN DOES THE CONVENTION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/customs/customs cooperation/Close cooperation between EU customs administrations <span style=color:#000;font-weight:700>(</span>Naples II Convention<span style=color:#000;font-weight:700>)</span>.txt:89:FROM WHEN DOES THE CONVENTION APPLY?
</span></span></code></pre></div><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DOES THE FRAMEWORK DECISION APPLY?'</code></p><ul><li>output:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/police and customs cooperation/Simplifying the exchange of information between EU countries_ police and customs.txt:65:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/police and customs cooperation/Joint investigation teams.txt:53:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/police and customs cooperation/EU cooperation in criminal matters — personal data protection <span style=color:#000;font-weight:700>(</span><span style=color:#000;font-weight:700>until</span> 2018<span style=color:#000;font-weight:700>)</span>.txt:117:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/Recognition and execution of confiscation orders.txt:165:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/Exchange of information on criminal records between EU countries.txt:125:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/EU mutual recognition system – prison sentences and prisoner transfers.txt:61:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/Mutual recognition of probation measures and alternative sanctions.txt:69:WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/judicial cooperation in criminal matters/EU cooperation in criminal matters — personal data protection <span style=color:#000;font-weight:700>(</span><span style=color:#000;font-weight:700>until</span> 2018<span style=color:#000;font-weight:700>)</span>.txt:117:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/justice_freedom_security/fight against organised crime/Fight against organised crime offences linked to participation in a criminal organisation.txt:113:FROM WHEN DOES THE FRAMEWORK DECISION APPLY?
</span></span></code></pre></div><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DO THE REGULATION AND DECISION APPLY?'</code></p><ul><li>output:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/last_to_use/economic_and_monetary_affairs/stability and growth pact and economic policy coordination/Financial assistance to Cyprus.txt:69:FROM WHEN DO THE REGULATION AND DECISION APPLY?
</span></span></code></pre></div><p>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e 'WHEN DOES THE AGREEMENT AND PROTOCOL APPLY?'</code></p><ul><li>output:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>NONE FOUND
</span></span></code></pre></div><p>So, it was getting too boring so I decided to use lazy comparisions, at least that is what official documents of regular expressions says ;)</p><ul><li>code: <code>grep -rwn -i /home/jay/Data_Pre/last_to_use/ -e '^.*APPLY?$'</code></li></ul><p>The output of this command is too big, but I would say that its effecitve.</p><p>Now, that we know the regualr expression, what we can do is something like this.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>re</span> 
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>os</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># Complie the regular expression</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>apply <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>compile(<span style=color:#d14>r</span><span style=color:#d14>&#39;^.*APPLY\?$&#39;</span>) <span style=color:#998;font-style:italic># We will not ignore case here because of the fact that our required lines are in uppercase</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># Iterate through the files in the target folder</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>for</span> root, dirs, files <span style=color:#000;font-weight:700>in</span> os<span style=color:#000;font-weight:700>.</span>walk(<span style=color:#d14>&#39;/home/jay/Data_Pre/last_to_use/&#39;</span>):
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>for</span> file <span style=color:#000;font-weight:700>in</span> files:
</span></span><span style=display:flex><span>        topic <span style=color:#000;font-weight:700>=</span> root<span style=color:#000;font-weight:700>.</span>split(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>sep)[<span style=color:#000;font-weight:700>-</span><span style=color:#099>2</span>]    <span style=color:#998;font-style:italic># Topic and subtopic will be useful while saving the files</span>
</span></span><span style=display:flex><span>        subtopic <span style=color:#000;font-weight:700>=</span> root<span style=color:#000;font-weight:700>.</span>split(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>sep)[<span style=color:#000;font-weight:700>-</span><span style=color:#099>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># Open the file and read its contents</span>
</span></span><span style=display:flex><span>        wtih <span style=color:#0086b3>open</span>(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>join(root, file)) <span style=color:#000;font-weight:700>as</span> f:
</span></span><span style=display:flex><span>            contents <span style=color:#000;font-weight:700>=</span> f<span style=color:#000;font-weight:700>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>               <span style=color:#998;font-style:italic># define the ending index of the file</span>
</span></span><span style=display:flex><span>               end_index <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#998;font-style:italic># Iterate through all the lines in contents and search for the compiled regular expressions</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>for</span> index, line <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>enumerate</span>(contents):
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>if</span> apply<span style=color:#000;font-weight:700>.</span>search(line) <span style=color:#000;font-weight:700>is</span> <span style=color:#000;font-weight:700>not</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>                    <span style=color:#998;font-style:italic># If we found the a match, set the end index to be the index of this line </span>
</span></span><span style=display:flex><span>                    end_index <span style=color:#000;font-weight:700>=</span> index
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>break</span>  <span style=color:#998;font-style:italic># because we don&#39;t want to search ahead, we found a match </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            new_contents <span style=color:#000;font-weight:700>=</span> contents[:end_index]  <span style=color:#998;font-style:italic># We are creating new list of contents but with the end of that being end_index</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#998;font-style:italic># Check where to save</span>
</span></span><span style=display:flex><span>            path_to_write <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;~/Data_Pre/preprocessed/&#39;</span><span style=color:#000;font-weight:700>+</span>topic<span style=color:#000;font-weight:700>+</span><span style=color:#d14>&#39;/&#39;</span><span style=color:#000;font-weight:700>+</span>subtopic
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>try</span>:
</span></span><span style=display:flex><span>                    os<span style=color:#000;font-weight:700>.</span>stat(path_to_write)
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>except</span>:
</span></span><span style=display:flex><span>                    os<span style=color:#000;font-weight:700>.</span>makedirs(path_to_write)
</span></span><span style=display:flex><span>                <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Saving file at: </span><span style=color:#d14>{}</span><span style=color:#d14>&#34;</span><span style=color:#000;font-weight:700>.</span>format(path_to_write))
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>with</span> <span style=color:#0086b3>open</span>(path_to_write<span style=color:#000;font-weight:700>+</span><span style=color:#d14>&#39;/&#39;</span><span style=color:#000;font-weight:700>+</span>file, <span style=color:#d14>&#34;w&#34;</span>) <span style=color:#000;font-weight:700>as</span> file_to_write:
</span></span><span style=display:flex><span>                    file_to_write<span style=color:#000;font-weight:700>.</span>write(<span style=color:#d14>&#39;&#39;</span><span style=color:#000;font-weight:700>.</span>join(new_contents))
</span></span></code></pre></div><p>We used the same regular expression but in python <code>apply = re.compile(r'^.*APPLY\?$') # We will not ignore case here because of the fact that our required lines are in uppercase</code></p><p>Let&rsquo;s make sure we are successful</p><p>Now, Let&rsquo;s go and see if we are successful in removing the above mentioned expression</p><p>code: <code>grep -nwr -i ~/Data_Pre/preprocessed/ -e '^.*APPLY?'</code></p><p>output:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/judicial cooperation in civil matters/Law applicable to divorce and legal separation.txt:33:When does the regulation apply?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/free movement of persons, asylum and immigration/Rules on movement of people across EU borders.txt:49:To whom does it apply?
</span></span></code></pre></div><p>We we able to remove all but two lines containing the word apply, so all in all this was a good result</p><p>Let&rsquo;s do same for sentences with FORCE at the end</p><p>code:<code>grep -nwr -i ~/Data_Pre/preprocessed/ -e '^.*FORCE\?$'</code></p><p>output:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/transport/air transport/Single European Sky - EU rules on air navigation services.txt:109:WHEN DOES THE REGULATION COME INTO FORCE?
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/single market <span style=color:#000;font-weight:700>for</span> goods/Machinery safety.txt:129:WHEN DID THIS DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/citizenship of the union/EU freedom of movement and residence.txt:77:WHEN DID THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/judicial cooperation in criminal matters/Fair trial suspects’ right to interpretation and translation in criminal proceedings.txt:113:WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/free movement of persons, asylum and immigration/EU freedom of movement and residence.txt:77:WHEN DID THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/institutional_affairs/the institutions, bodies and agencies of the union/The EU’s spending watchdog how the European Court of Auditors operates.txt:189:WHEN DID THE RULES OF PROCEDURE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/institutional_affairs/the decision-making process and the work of the institutions/Lobbying regulation the EU’s transparency register.txt:53:WHEN DID THE AGREEMENT ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/enterprise/business environment/Combating late payment in business dealings.txt:61:FROM WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/food_safety/veterinary checks, animal health rules, food hygiene/Horses <span style=color:#000;font-weight:700>(</span>semen, ova _ embryos<span style=color:#000;font-weight:700>)</span> – trade within the EU.txt:97:FROM WHEN DOES THIS DIRECTIVE COME INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/consumers/consumer safety/Defective products liability.txt:249:FROM WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/consumers/consumer safety/Machinery safety.txt:129:WHEN DID THIS DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/employment_and_social_policy/health, hygiene and safety at work/Statistics on public healthhealth _ safety at work.txt:233:WHEN DID THIS REGULATION ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/education_training_youth/education and training/Lawyers practising abroad on a permanent basis — EU rules.txt:81:WHEN DOES THE DIRECTIVE ENTER INTO FORCE?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/education_training_youth/education and training/EU freedom of movement and residence.txt:77:WHEN DID THE DIRECTIVE ENTER INTO FORCE?
</span></span></code></pre></div><p>So, let&rsquo;s remove those, and <code>MAY THE FORCE BE WITH US</code></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>re</span> 
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>os</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># Complie the regular expression</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>apply <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>compile(<span style=color:#d14>r</span><span style=color:#d14>&#39;^.*FORCE\?$&#39;</span>) <span style=color:#998;font-style:italic># We will not ignore case here because of the fact that our required lines are in uppercase</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># Iterate through the files in the target folder</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>for</span> root, dirs, files <span style=color:#000;font-weight:700>in</span> os<span style=color:#000;font-weight:700>.</span>walk(<span style=color:#d14>&#39;/home/jay/Data_Pre/last_to_use/&#39;</span>):
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>for</span> file <span style=color:#000;font-weight:700>in</span> files:
</span></span><span style=display:flex><span>        topic <span style=color:#000;font-weight:700>=</span> root<span style=color:#000;font-weight:700>.</span>split(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>sep)[<span style=color:#000;font-weight:700>-</span><span style=color:#099>2</span>]    <span style=color:#998;font-style:italic># Topic and subtopic will be useful while saving the files</span>
</span></span><span style=display:flex><span>        subtopic <span style=color:#000;font-weight:700>=</span> root<span style=color:#000;font-weight:700>.</span>split(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>sep)[<span style=color:#000;font-weight:700>-</span><span style=color:#099>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#998;font-style:italic># Open the file and read its contents</span>
</span></span><span style=display:flex><span>        wtih <span style=color:#0086b3>open</span>(os<span style=color:#000;font-weight:700>.</span>path<span style=color:#000;font-weight:700>.</span>join(root, file)) <span style=color:#000;font-weight:700>as</span> f:
</span></span><span style=display:flex><span>            contents <span style=color:#000;font-weight:700>=</span> f<span style=color:#000;font-weight:700>.</span>readlines()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>               <span style=color:#998;font-style:italic># define the ending index of the file</span>
</span></span><span style=display:flex><span>               end_index <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#998;font-style:italic># Iterate through all the lines in contents and search for the compiled regular expressions</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>for</span> index, line <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>enumerate</span>(contents):
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>if</span> apply<span style=color:#000;font-weight:700>.</span>search(line) <span style=color:#000;font-weight:700>is</span> <span style=color:#000;font-weight:700>not</span> <span style=color:#000;font-weight:700>None</span>:
</span></span><span style=display:flex><span>                    <span style=color:#998;font-style:italic># If we found the a match, set the end index to be the index of this line </span>
</span></span><span style=display:flex><span>                    end_index <span style=color:#000;font-weight:700>=</span> index
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>break</span>  <span style=color:#998;font-style:italic># because we don&#39;t want to search ahead, we found a match </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            new_contents <span style=color:#000;font-weight:700>=</span> contents[:end_index]  <span style=color:#998;font-style:italic># We are creating new list of contents but with the end of that being end_index</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#998;font-style:italic># Check where to save</span>
</span></span><span style=display:flex><span>            path_to_write <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;~/Data_Pre/preprocessed/&#39;</span><span style=color:#000;font-weight:700>+</span>topic<span style=color:#000;font-weight:700>+</span><span style=color:#d14>&#39;/&#39;</span><span style=color:#000;font-weight:700>+</span>subtopic
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>try</span>:
</span></span><span style=display:flex><span>                    os<span style=color:#000;font-weight:700>.</span>stat(path_to_write)
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>except</span>:
</span></span><span style=display:flex><span>                    os<span style=color:#000;font-weight:700>.</span>makedirs(path_to_write)
</span></span><span style=display:flex><span>                <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;Saving file at: </span><span style=color:#d14>{}</span><span style=color:#d14>&#34;</span><span style=color:#000;font-weight:700>.</span>format(path_to_write))
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>with</span> <span style=color:#0086b3>open</span>(path_to_write<span style=color:#000;font-weight:700>+</span><span style=color:#d14>&#39;/&#39;</span><span style=color:#000;font-weight:700>+</span>file, <span style=color:#d14>&#34;w&#34;</span>) <span style=color:#000;font-weight:700>as</span> file_to_write:
</span></span><span style=display:flex><span>                    file_to_write<span style=color:#000;font-weight:700>.</span>write(<span style=color:#d14>&#39;&#39;</span><span style=color:#000;font-weight:700>.</span>join(new_contents))
</span></span></code></pre></div><p>Let&rsquo;s verify that we are successful</p><p>code: <code>grep -nwr -i ~/Data_Pre/preprocessed/ -e '^.*FORCE\?$'</code></p><p>output:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>None Found
</span></span></code></pre></div><p>We have almost parsed the documents to be used for preprocessing before we create word embeddings out of it, but there are a few more things to be taken care of</p><ul><li>RELATED ACT</li><li>RELATED DOCUMENTS</li><li>RELATED INSTRUMENTS</li></ul><p>These above mentioned points are to be removed as well. So let&rsquo;s do the same for these.</p><p>For apply we used starting marker <code>^</code> and ending marker <code>$</code> which we will do for word <code>RELATED</code></p><p>code: <code>grep -nwr -i ~/Data_Pre/preprocessed/ -e '^RELATED.*$'</code></p><p>output:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/transport/waterborne transport/Mandatory checks on regular ro-ro ferries and high-speed passenger craft.txt:65:Related legislation on port state control aims to outlaw substandard shipping in the EU. It requires all vessels to comply with EU and international safety standards, as contained in the International Convention <span style=color:#000;font-weight:700>for</span> the Safety of Life at Sea <span style=color:#000;font-weight:700>(</span>SOLAS<span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>for</span> instance.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/transport/rail transport/An interoperable EU rail system.txt:117:related European standards and other documents allowing the bodies involved to prove their compliance with the essential requirements and TSIs.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/businesses in the internal market/Copyright and related rights term of protection.txt:21:Related rights
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/single market <span style=color:#000;font-weight:700>for</span> goods/Electrical equipment designed <span style=color:#000;font-weight:700>for</span> use within certain voltage limits.txt:277:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/single market <span style=color:#000;font-weight:700>for</span> services/Remuneration policies in the financial services sector.txt:121:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against organised crime/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against organised crime/European Cybercrime Centre at Europol.txt:77:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/free movement of persons, asylum and immigration/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against terrorism/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against terrorism/Fight against terrorism – definitions of terrorist crimes and support to victims.txt:57:Related offences
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/agriculture/markets <span style=color:#000;font-weight:700>for</span> agricultural products/Towards a sustainable wine sector.txt:249:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/consumers/consumer safety/Electrical equipment designed <span style=color:#000;font-weight:700>for</span> use within certain voltage limits.txt:277:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/maritime_affairs_and_fisheries/maritime affairs/Maritime Policy Green Paper.txt:29:related services <span style=color:#000;font-weight:700>(</span>because of the expertise in marine technology<span style=color:#000;font-weight:700>)</span>.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/environment/tackling climate change/Maritime Policy Green Paper.txt:29:related services <span style=color:#000;font-weight:700>(</span>because of the expertise in marine technology<span style=color:#000;font-weight:700>)</span>.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/regional_policy/review and the future of regional policy/Cohesion policy and cities.txt:161:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/regional_policy/review and the future of regional policy/Regions <span style=color:#000;font-weight:700>for</span> economic change.txt:53:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/foreign_and_security_policy/implementation of the cfsp and esdp/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/employment_and_social_policy/social and employment situation in europe/Report on employment in Europe 2004.txt:81:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/information_society/digital strategy, i2010 strategy, eeurope action plan, digital strategy programmes/The EU_s new digital single market strategy.txt:133:RELATED ACT
</span></span></code></pre></div><p>We have some problem with this approach</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/transport/waterborne transport/Mandatory checks on regular ro-ro ferries and high-speed passenger craft.txt:65:Related legislation on port state control aims to outlaw substandard shipping in the EU. It requires all vessels to comply with EU and international safety standards, as contained in the International Convention <span style=color:#000;font-weight:700>for</span> the Safety of Life at Sea <span style=color:#000;font-weight:700>(</span>SOLAS<span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>for</span> instance.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/transport/rail transport/An interoperable EU rail system.txt:117:related European standards and other documents allowing the bodies involved to prove their compliance with the essential requirements and TSIs.
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/businesses in the internal market/Copyright and related rights term of protection.txt:21:Related rights
</span></span></code></pre></div><p>See how we got some lines with apply in it, this can be a problem as we don&rsquo;t want to remove anything except for those tags</p><p>The problem is, when we pass the ignore case parameter we get some useful text as output which might be necessary so we will not use the ignore case parameter and run the above command again</p><p>code: <code>grep -nwr ~/Data_Pre/preprocessed/ -e '^RELATED.*$'</code></p><p>output:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/single market <span style=color:#000;font-weight:700>for</span> goods/Electrical equipment designed <span style=color:#000;font-weight:700>for</span> use within certain voltage limits.txt:277:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/internal_market/single market <span style=color:#000;font-weight:700>for</span> services/Remuneration policies in the financial services sector.txt:121:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against organised crime/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against organised crime/European Cybercrime Centre at Europol.txt:77:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/free movement of persons, asylum and immigration/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/justice_freedom_security/fight against terrorism/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/agriculture/markets <span style=color:#000;font-weight:700>for</span> agricultural products/Towards a sustainable wine sector.txt:249:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/consumers/consumer safety/Electrical equipment designed <span style=color:#000;font-weight:700>for</span> use within certain voltage limits.txt:277:RELATED ACT
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/regional_policy/review and the future of regional policy/Cohesion policy and cities.txt:161:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/regional_policy/review and the future of regional policy/Regions <span style=color:#000;font-weight:700>for</span> economic change.txt:53:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/foreign_and_security_policy/implementation of the cfsp and esdp/EU internal security strategy.txt:209:RELATED DOCUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/employment_and_social_policy/social and employment situation in europe/Report on employment in Europe 2004.txt:81:RELATED INSTRUMENTS
</span></span><span style=display:flex><span>/home/jay/Data_Pre/preprocessed/information_society/digital strategy, i2010 strategy, eeurope action plan, digital strategy programmes/The EU_s new digital single market strategy.txt:133:RELATED ACT
</span></span></code></pre></div><p>And we seem to have solved the problem</p><p>So, now we will use same python code from above but with change in the <code>compile</code> function</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>related <span style=color:#000;font-weight:700>=</span> re<span style=color:#000;font-weight:700>.</span>compile(<span style=color:#d14>r</span><span style=color:#d14>&#39;^RELATED.*$&#39;</span>) <span style=color:#998;font-style:italic># Note that we will not use ignore case flag here</span>
</span></span></code></pre></div><p>Every thing is set and we are ready to preprocess the files!!!</p></div></article><button class=floating-button>
<a class=floating-button__link href=https://jdvala.github.io><span>home</span></a></button></div><footer class=post-footer><div class=footer><div>© 2020, Jay Vala. Theme - Origin by Andrey Parfenov</div><div class=footer__socials><a href=www.github.com/jdvala target=_blank class=social-link title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0v24h24V0H0zm14.534 19.59c-.406.078-.534-.171-.534-.384v-2.195c0-.747-.262-1.233-.55-1.481 1.782-.198 3.654-.875 3.654-3.947.0-.874-.311-1.588-.824-2.147.083-.202.357-1.016-.079-2.117.0.0-.671-.215-2.198.82-.639-.18-1.323-.267-2.003-.271-.68.003-1.364.091-2.003.269-1.528-1.035-2.2-.82-2.2-.82-.434 1.102-.16 1.915-.077 2.118-.512.56-.824 1.273-.824 2.147.0 3.064 1.867 3.751 3.645 3.954-.229.2-.436.552-.508 1.07-.457.204-1.614.557-2.328-.666.0.0-.423-.768-1.227-.825.0.0-.78-.01-.055.487.0.0.525.246.889 1.17.0.0.463 1.428 2.688.944v1.489c0 .211-.129.459-.528.385C6.292 18.533 4 15.534 4 12c0-4.419 3.582-8 8-8s8 3.581 8 8c0 3.533-2.289 6.531-5.466 7.59z"/></svg></a></div></div></footer><script src=https://jdvala.github.io/js/script.js></script></body></html>